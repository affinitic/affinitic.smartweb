<html
  xmlns="http://www.w3.org/1999/xhtml"
  xml:lang="en"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  lang="en"
  metal:use-macro="context/@@main_template/macros/master"
  i18n:domain="plone"
>
  <body>
    <metal:main fill-slot="content-core">
      <metal:content-core define-macro="content-core">
        <metal:macro use-macro="context/@@sections_macros/section_edition" />
        <div class="sectiontext" tal:define="section_context view/get_context">
          <div
            tal:define="image section_context/image | nothing;
                            collapse_klass_container python: 'section-text-collapsed' if section_context.collapsible_section else '';"
            id=""
            tal:attributes="class string:container section-container section-text ${collapse_klass_container};
                                id string:container-section-${section_context/id};"
          >
              <tal:def tal:define="hide_title section_context/hide_title;
                      collapsible_section section_context/collapsible_section"
                      i18n:domain="imio.smartweb">

                <h2 tal:condition="not: hide_title"
                    class="section-title"><a
                    href=""
                    role="button"
                    aria-expanded="false"
                    data-bs-toggle="collapse"
                    data-bs-target=""
                    tal:omit-tag="not: collapsible_section"
                    tal:attributes="data-bs-target string:#body-section-${section_context/id}"
                    tal:content="section_context/title"
                /></h2>
                <h2 tal:condition="python: can_edit_sections and hide_title"
                    class="hidden-section-title hide-in-preview"><a
                    href=""
                    role="button"
                    aria-expanded="false"
                    data-bs-toggle="collapse"
                    data-bs-target=""
                    tal:omit-tag="not: collapsible_section"
                    tal:attributes="data-bs-target string:#body-section-${section_context/id}"
                    tal:content="section_context/title"
                /></h2>

              </tal:def>

            <div
              tal:define="collapse_klass python: 'collapse' if section_context.collapsible_section else '';
                              klass string:body-section figure-${section_context/alignment} figure-${section_context/image_size} ${collapse_klass};"
              tal:attributes="class python:'{} {}'.format(klass, 'no-image') if not image else klass;
                                  id string:body-section-${section_context/id}"
            >
              <tal:cond condition="image">
                <figure>
                  <img
                    tal:attributes="src python:view.get_scale_url(section_context); alt python:section_context.image_caption if section_context.image_caption else ''"
                  />
                  <figcaption
                    tal:condition="section_context/image_caption"
                    tal:content="section_context/image_caption"
                  ></figcaption>
                </figure>
              </tal:cond>
              <div
                class="text"
                tal:content="structure section_context/text/output | nothing"
              />
            </div>
          </div>
        </div>
      </metal:content-core>
    </metal:main>
  </body>
</html>
